---
title: Limpiar datos con directivas de retención | Microsoft Docs
description: Puede especificar la frecuencia con la que desea eliminar ciertos tipos de datos.
author: bholtorf
ms.service: dynamics365-business-central
ms.topic: conceptual
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.keywords: delete, data, retention, policy, policies
ms.date: 04/01/2021
ms.author: bholtorf
ms.openlocfilehash: e9d8f9fc9b74df561aab3109b631fc10c7f46108
ms.sourcegitcommit: 766e2840fd16efb901d211d7fa64d96766ac99d9
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 03/31/2021
ms.locfileid: "5780062"
---
# <a name="define-retention-policies"></a><span data-ttu-id="63ca6-103">Definir directivas de retención</span><span class="sxs-lookup"><span data-stu-id="63ca6-103">Define Retention Policies</span></span>
<span data-ttu-id="63ca6-104">Los administradores pueden definir directivas de retención para especificar con qué frecuencia desean que [!INCLUDE[prod_short](includes/prod_short.md)] elimine datos desactualizados en tablas que contienen entradas de registro y registros archivados.</span><span class="sxs-lookup"><span data-stu-id="63ca6-104">Administrators can define retention policies to specify how frequently they want [!INCLUDE[prod_short](includes/prod_short.md)] to delete outdated data in tables that contain log entries and archived records.</span></span> <span data-ttu-id="63ca6-105">Por ejemplo, limpiar las entradas de registro puede facilitar el trabajo con los datos que son realmente relevantes.</span><span class="sxs-lookup"><span data-stu-id="63ca6-105">For example, cleaning up log entries can make it easier to work with the data that's actually relevant.</span></span> <span data-ttu-id="63ca6-106">Las directivas pueden incluir todos los datos de las tablas que superan la fecha de vencimiento, o puede agregar criterios de filtro que incluirán solo ciertos datos vencidos en la directiva.</span><span class="sxs-lookup"><span data-stu-id="63ca6-106">Policies can include all data in the tables that is past the expiration date, or you can add filter criteria that will include only certain expired data in the policy.</span></span> 

## <a name="required-setups-and-permissions"></a><span data-ttu-id="63ca6-107">Configuraciones y permisos necesarios</span><span class="sxs-lookup"><span data-stu-id="63ca6-107">Required Setups and Permissions</span></span>
<span data-ttu-id="63ca6-108">Antes de que pueda crear directivas de retención, debe configurar lo siguiente.</span><span class="sxs-lookup"><span data-stu-id="63ca6-108">Before you can create retention policies, you must set up the following.</span></span>

|<span data-ttu-id="63ca6-109">Configurar</span><span class="sxs-lookup"><span data-stu-id="63ca6-109">Setup</span></span>  |<span data-ttu-id="63ca6-110">Descripción</span><span class="sxs-lookup"><span data-stu-id="63ca6-110">Description</span></span>  |
|---------|---------|
|<span data-ttu-id="63ca6-111">**Tablas permitidas**</span><span class="sxs-lookup"><span data-stu-id="63ca6-111">**Allowed Tables**</span></span>     |<span data-ttu-id="63ca6-112">Proporcionamos una lista de las tablas que se pueden incluir en las directivas de retención.</span><span class="sxs-lookup"><span data-stu-id="63ca6-112">We provide a list of the tables that can be included in retention policies.</span></span> <span data-ttu-id="63ca6-113">Sin embargo, si desea agregar tablas desde una extensión a una directiva de retención, un desarrollador debe agregar sus tablas a la lista.</span><span class="sxs-lookup"><span data-stu-id="63ca6-113">However, if you want to add tables from an extension to a retention policy a developer must add their tables to the list.</span></span> <span data-ttu-id="63ca6-114">Para más información, consulte [Incluir su extensión en una directiva de retención](admin-data-retention-policies.md#including-your-extension-in-a-retention-policy-requires-help-from-a-developer).</span><span class="sxs-lookup"><span data-stu-id="63ca6-114">For more information, see [Including Your Extension in a Retention Policy](admin-data-retention-policies.md#including-your-extension-in-a-retention-policy-requires-help-from-a-developer).</span></span>          |
|<span data-ttu-id="63ca6-115">**Períodos de retención**</span><span class="sxs-lookup"><span data-stu-id="63ca6-115">**Retention Periods**</span></span>     |<span data-ttu-id="63ca6-116">Especifique períodos de tiempo durante los cuales se conservarán los datos en las tablas de una directiva.</span><span class="sxs-lookup"><span data-stu-id="63ca6-116">Specify periods of time for which to keep data in the tables in a policy.</span></span> <span data-ttu-id="63ca6-117">Los períodos determinan la frecuencia con la que se eliminarán los datos.</span><span class="sxs-lookup"><span data-stu-id="63ca6-117">The periods determine how often data will be deleted.</span></span>         |

<span data-ttu-id="63ca6-118">Además, debe tener los permisos de usuario SUPER o el permiso de configuración de la directiva de retención establecida.</span><span class="sxs-lookup"><span data-stu-id="63ca6-118">Additionally, you must have the SUPER user permissions or the Retention Policy Setup permission set.</span></span> <span data-ttu-id="63ca6-119">Los usuarios a los que se les concede el conjunto de permisos Configuración de directivas de retención pueden definir directivas de retención para las tablas, incluso si no tienen permisos de lectura y eliminación para esas tablas.</span><span class="sxs-lookup"><span data-stu-id="63ca6-119">Users who are granted the Retention Policy Setup permission set can define retention policies for tables, even if they do not have Read and Delete permissions for those tables.</span></span> <span data-ttu-id="63ca6-120">La entrada de la cola de trabajos debe ejecutarse como un usuario con permisos para leer y eliminar los datos.</span><span class="sxs-lookup"><span data-stu-id="63ca6-120">The job queue entry must run as a user with permissions to read and delete the data.</span></span> <span data-ttu-id="63ca6-121">Se recomienda que no otorgue el conjunto de permisos de Configuración de la directiva de retención a los usuarios a los que no se les debería permitir eliminar datos.</span><span class="sxs-lookup"><span data-stu-id="63ca6-121">We recommend that you do not grant the Retention Policy Setup permission set to users who should not be allowed to delete data.</span></span>

> [!NOTE]
> <span data-ttu-id="63ca6-122">Si esta usando [!INCLUDE[prod_short](includes/prod_short.md)] local, y desea probar las directivas de retención en la base de datos de demostración Cronus, hay algunas cosas que debe hacer.</span><span class="sxs-lookup"><span data-stu-id="63ca6-122">If you are using [!INCLUDE[prod_short](includes/prod_short.md)] on-premises, and you want to try out retention policies in the the Cronus demonstration database, there are a few things you need to do.</span></span> <span data-ttu-id="63ca6-123">La empresa de demostración no contiene tablas que pueda usar con directivas de retención, por lo que debe agregarlas.</span><span class="sxs-lookup"><span data-stu-id="63ca6-123">The demonstration company does not contain tables that you can use with retention policies, so you need to add them.</span></span> <span data-ttu-id="63ca6-124">Para ello, cree una nueva empresa en blanco en la base de datos de demostración.</span><span class="sxs-lookup"><span data-stu-id="63ca6-124">To do that, create a new, blank company in the demonstration database.</span></span> <span data-ttu-id="63ca6-125">En la nueva empresa, importe el paquete de configuración RapidStart para su país que corresponda al paquete estándar NAV17.0.W1.ENU.STANDARD.rapidstart.</span><span class="sxs-lookup"><span data-stu-id="63ca6-125">In the new company, import the RapidStart configuration package for your country that corresponds to the standard NAV17.0.W1.ENU.STANDARD.rapidstart package.</span></span> <span data-ttu-id="63ca6-126">Los datos de configuración de las directivas de retención estarán disponibles en la nueva empresa.</span><span class="sxs-lookup"><span data-stu-id="63ca6-126">The setup data for retention policies will be available in the new company.</span></span>

### <a name="to-create-retention-periods"></a><span data-ttu-id="63ca6-127">Para crear períodos de retención</span><span class="sxs-lookup"><span data-stu-id="63ca6-127">To create retention periods</span></span>
<span data-ttu-id="63ca6-128">Los períodos de retención pueden ser tan largos o cortos como desee.</span><span class="sxs-lookup"><span data-stu-id="63ca6-128">Retention periods can be as long or as short as you want.</span></span> <span data-ttu-id="63ca6-129">Para crear períodos de retención, en la página **Políticas de retención**, utilice la acción **Periodo de retención**.</span><span class="sxs-lookup"><span data-stu-id="63ca6-129">To create retention periods, on the **Retention Policies** page, use the **Retention Period** action.</span></span> <span data-ttu-id="63ca6-130">Los períodos que defina estarán disponibles para todas las pólizas.</span><span class="sxs-lookup"><span data-stu-id="63ca6-130">The periods you define will be available for all policies.</span></span>

> [!NOTE]
> <span data-ttu-id="63ca6-131">Por razones de cumplimiento, hemos definido un período de retención mínimo para algunas tablas.</span><span class="sxs-lookup"><span data-stu-id="63ca6-131">For compliance reasons, we have defined a minimum retention period for some tables.</span></span> <span data-ttu-id="63ca6-132">Si establece un período de retención más corto que el mínimo requerido, un mensaje mostrará el período obligatorio.</span><span class="sxs-lookup"><span data-stu-id="63ca6-132">If you set a retention period that is shorter than minimum required, a message will display the mandatory period.</span></span>

### <a name="set-up-a-retention-policy"></a><span data-ttu-id="63ca6-133">Configurar una directiva retención</span><span class="sxs-lookup"><span data-stu-id="63ca6-133">Set up a retention policy</span></span>
1. <span data-ttu-id="63ca6-134">Elija el icono ![Bombilla que abre la función Dígame](media/ui-search/search_small.png "Dígame qué desea hacer"), introduzca **Directivas de retención** y luego elija el vínculo relacionado.</span><span class="sxs-lookup"><span data-stu-id="63ca6-134">Choose the ![Lightbulb that opens the Tell Me feature](media/ui-search/search_small.png "Tell me what you want to do") icon, enter **Retention Policies**, and choose the related link.</span></span>
2. <span data-ttu-id="63ca6-135">En el campo **Id. de tabla**, seleccione la tabla que desee incluir en la directiva.</span><span class="sxs-lookup"><span data-stu-id="63ca6-135">In the **Table ID** field, choose the table that you want to include in the policy.</span></span>
3. <span data-ttu-id="63ca6-136">En el campo **Periodo de retención**, especifique el período de tiempo durante el cual se conservarán los datos en la tabla.</span><span class="sxs-lookup"><span data-stu-id="63ca6-136">In the **Retention Period** field, specify the length of time for which to keep the data in the table.</span></span>
4. <span data-ttu-id="63ca6-137">Opcional: para aplicar la directiva a datos específicos en una tabla, desactive la opción Aplicar a todos los registros.</span><span class="sxs-lookup"><span data-stu-id="63ca6-137">Optional: To apply the policy to specific data in a table, turn off the Apply to all records toggle.</span></span> <span data-ttu-id="63ca6-138">Aparecerá la Ficha desplegable Política de retención de registros, donde puede establecer filtros para crear subconjuntos de datos para cada línea.</span><span class="sxs-lookup"><span data-stu-id="63ca6-138">The Record Retention Policy FastTab will display, where you can set filters to create subsets of data for each line.</span></span> <span data-ttu-id="63ca6-139">Para obtener más información, consulte [Filtrado](ui-enter-criteria-filters.md#filtering).</span><span class="sxs-lookup"><span data-stu-id="63ca6-139">For more information, see [Filtering](ui-enter-criteria-filters.md#filtering).</span></span>

   > [!NOTE]
   > <span data-ttu-id="63ca6-140">Cada línea tiene su propio período de retención.</span><span class="sxs-lookup"><span data-stu-id="63ca6-140">Each line has its own retention period.</span></span> <span data-ttu-id="63ca6-141">Si especifica diferentes períodos de retención para los mismos datos, se utilizará el período más largo.</span><span class="sxs-lookup"><span data-stu-id="63ca6-141">If you specify different retention periods for the same data, the longest period will be used.</span></span> <span data-ttu-id="63ca6-142">Además, algunas tablas contienen filtros que no puede cambiar ni eliminar.</span><span class="sxs-lookup"><span data-stu-id="63ca6-142">Also, some tables contain filters that you cannot change or remove.</span></span> <span data-ttu-id="63ca6-143">Para ayudarlo a identificar estos filtros, aparecen en una fuente de color más claro.</span><span class="sxs-lookup"><span data-stu-id="63ca6-143">To help you identify these filters, they appear in a lighter color font.</span></span>

## <a name="applying-retention-policies"></a><span data-ttu-id="63ca6-144">Aplicación de directivas de retención</span><span class="sxs-lookup"><span data-stu-id="63ca6-144">Applying Retention Policies</span></span>
<span data-ttu-id="63ca6-145">Puede utilizar una entrada de la cola de trabajos para aplicar directivas de retención para eliminar datos automáticamente, o puede aplicar directivas manualmente.</span><span class="sxs-lookup"><span data-stu-id="63ca6-145">You can use a job queue entry to apply retention policies to delete data automatically, or you can manually apply policies.</span></span>

<span data-ttu-id="63ca6-146">Para aplicar una directiva de retención automáticamente, simplemente cree y habilite una directiva.</span><span class="sxs-lookup"><span data-stu-id="63ca6-146">To apply a retention policy automatically, just create and enable a policy.</span></span> <span data-ttu-id="63ca6-147">Cuando habilita una directiva, se crea una entrada en la cola de trabajos que aplicará directivas de retención de acuerdo con el período de retención que especifique.</span><span class="sxs-lookup"><span data-stu-id="63ca6-147">When you enable a policy we create a job queue entry that will apply retention policies according to the retention period you specify.</span></span> <span data-ttu-id="63ca6-148">Todas las directivas de retención utilizarán la misma entrada de cola de trabajos.</span><span class="sxs-lookup"><span data-stu-id="63ca6-148">All retention policies will use the same job queue entry.</span></span> <span data-ttu-id="63ca6-149">De forma predeterminada, la entrada de la cola de trabajos aplica la directiva todos los días a las 0200.</span><span class="sxs-lookup"><span data-stu-id="63ca6-149">By default, the job queue entry applies the policy every day at 0200.</span></span> <span data-ttu-id="63ca6-150">Puede cambiar el valor predeterminado, pero si lo hace, le recomendamos la ejecución fuera del horario comercial.</span><span class="sxs-lookup"><span data-stu-id="63ca6-150">You can change the default, but if you do we recommend that it runs outside business hours.</span></span> <span data-ttu-id="63ca6-151">Para obtener más información, consulte [Uso de colas de proyectos para programar tareas](admin-job-queues-schedule-tasks.md).</span><span class="sxs-lookup"><span data-stu-id="63ca6-151">For more information, see [Use Job Queues to Schedule Tasks](admin-job-queues-schedule-tasks.md).</span></span> 

<span data-ttu-id="63ca6-152">Puede aplicar manualmente una directiva mediante la acción **Aplicar manualmente** en la página **Políticas de retención**.</span><span class="sxs-lookup"><span data-stu-id="63ca6-152">You can manually apply a policy by using the **Apply Manually** action on the **Retention Policies** page.</span></span> <span data-ttu-id="63ca6-153">Si desea aplicar siempre una directiva manualmente, active la alternancia **Manual**.</span><span class="sxs-lookup"><span data-stu-id="63ca6-153">If you want to always apply a policy manually, turn on the **Manual** toggle.</span></span> <span data-ttu-id="63ca6-154">La entrada de la cola de trabajos ignorará la directiva cuando se ejecute.</span><span class="sxs-lookup"><span data-stu-id="63ca6-154">The job queue entry will disregard the policy when it runs.</span></span>

## <a name="viewing-retention-policy-log-entries"></a><span data-ttu-id="63ca6-155">Visualización de entradas de registro de directivas de retención</span><span class="sxs-lookup"><span data-stu-id="63ca6-155">Viewing Retention Policy Log Entries</span></span>
<span data-ttu-id="63ca6-156">Puede ver la actividad relacionada con las directivas de retención en la página **Registro de directivas de retención**.</span><span class="sxs-lookup"><span data-stu-id="63ca6-156">You can view activity related to retention policies in the **Retention Policy Log** page.</span></span> <span data-ttu-id="63ca6-157">Por ejemplo, las entradas se crean cuando se aplica una directiva o si ocurrieron errores cuando sucedió.</span><span class="sxs-lookup"><span data-stu-id="63ca6-157">For example, entries are created when when a policy is applied, or if errors occurred when that happened.</span></span> 

## <a name="including-your-extension-in-a-retention-policy-requires-help-from-a-developer"></a><span data-ttu-id="63ca6-158">Incluir su extensión en una directiva de retención (requiere ayuda de un desarrollador)</span><span class="sxs-lookup"><span data-stu-id="63ca6-158">Including Your Extension in a Retention Policy (Requires Help from a Developer)</span></span>
<span data-ttu-id="63ca6-159">De forma predeterminada, las directivas de retención cubren solo las tablas que están incluidas en la lista de tablas [!INCLUDE[prod_short](includes/prod_short.md)] que proporcionamos.</span><span class="sxs-lookup"><span data-stu-id="63ca6-159">By default, retention policies cover only tables that are included in the list of [!INCLUDE[prod_short](includes/prod_short.md)] tables that we provide.</span></span> <span data-ttu-id="63ca6-160">Puede eliminar tablas predeterminadas de la lista y puede agregar tablas de su propiedad.</span><span class="sxs-lookup"><span data-stu-id="63ca6-160">You can remove default tables from the list, and you can add tables that you own.</span></span> <span data-ttu-id="63ca6-161">Es decir, no puede agregar una tabla que no haya creado usted mismo.</span><span class="sxs-lookup"><span data-stu-id="63ca6-161">That is, you cannot add a table that you did not create yourself.</span></span> <span data-ttu-id="63ca6-162">Por ejemplo, no puede agregar otras tablas desde [!INCLUDE[prod_short](includes/prod_short.md)] o desde una extensión que haya comprado.</span><span class="sxs-lookup"><span data-stu-id="63ca6-162">For example, you cannot add other tables from [!INCLUDE[prod_short](includes/prod_short.md)] or from an extension that you have purchased.</span></span>

<span data-ttu-id="63ca6-163">Para agregar sus tablas a la lista de tablas permitidas, un desarrollador debe agregar algún código, por ejemplo, a la codeunit del instalador para la extensión (una codeunit con el subtipo *instalar*).</span><span class="sxs-lookup"><span data-stu-id="63ca6-163">To add your tables to the list of allowed tables, a developer must add some code, for example to the installer codeunit for the extension (a codeunit with the *install* subtype).</span></span> 

<span data-ttu-id="63ca6-164">Cuando un desarrollador agrega una tabla, puede especificar filtros obligatorios y predeterminados.</span><span class="sxs-lookup"><span data-stu-id="63ca6-164">When a developer adds a table, they can specify mandatory and default filters.</span></span> <span data-ttu-id="63ca6-165">Los filtros obligatorios no se pueden eliminar ni modificar más adelante cuando agrega tablas para definir una directiva de retención.</span><span class="sxs-lookup"><span data-stu-id="63ca6-165">Mandatory filters cannot be removed or modified later when you add tables to define a retention policy.</span></span> <span data-ttu-id="63ca6-166">Los filtros predeterminados son solo sugerencias cómodas.</span><span class="sxs-lookup"><span data-stu-id="63ca6-166">Default filters are just friendly suggestions.</span></span>

<span data-ttu-id="63ca6-167">Los siguientes son ejemplos de cómo agregar una tabla a la lista de tablas permitidas con y sin filtros obligatorios o predeterminados.</span><span class="sxs-lookup"><span data-stu-id="63ca6-167">The following are examples of how to add a table to the list of allowed tables with, and without, mandatory or default filters.</span></span> <span data-ttu-id="63ca6-168">Para obtener un ejemplo más complejo, consulte codeunit 3999 "Reten.</span><span class="sxs-lookup"><span data-stu-id="63ca6-168">For a more complex example, see codeunit 3999 "Reten.</span></span> <span data-ttu-id="63ca6-169">Pol.</span><span class="sxs-lookup"><span data-stu-id="63ca6-169">Pol.</span></span> <span data-ttu-id="63ca6-170">Instalar - BaseApp".</span><span class="sxs-lookup"><span data-stu-id="63ca6-170">Install - BaseApp".</span></span> 

```
 trigger OnInstallAppPerCompany()
    var
        RetenPolAllowedTables: Codeunit "Reten. Pol. Allowed Tables";
    begin
        RetenPolAllowedTables.AddAllowedTable(Database::"Retention Policy Log Entry");
    end;
```

<span data-ttu-id="63ca6-171">El siguiente ejemplo incluye un filtro obligatorio.</span><span class="sxs-lookup"><span data-stu-id="63ca6-171">The following example includes a mandatory filter.</span></span>

```
 trigger OnInstallAppPerCompany()
    var
        ChangeLogEntry: Record "Change Log Entry";
        RetenPolAllowedTables: Codeunit "Reten. Pol. Allowed Tables";
        RetentionPeriod: Enum "Retention Period Enum";
        RecRef: RecordRef;
        TableFilters: JsonArray;
        Enabled: Boolean;
        Mandatory: Boolean;
    begin
        ChangeLogEntry.Reset();
        ChangeLogEntry.SetFilter("Field Log Entry Feature", '%1|%2', ChangeLogEntry."Field Log Entry Feature"::"Monitor Sensitive Fields", ChangeLogEntry."Field Log Entry Feature"::All);
        RecRef.GetTable(ChangeLogEntry);
        Enabled := true;
        Mandatory := true;
        RetenPolAllowedTables.AddTableFilterToJsonArray(TableFilters, RetentionPeriod::"28 Days", ChangeLogEntry.FieldNo(SystemCreatedAt), Enabled, Mandatory, RecRef);
        RetenPolAllowedTables.AddAllowedTable(Database::"Change Log Entry", ChangeLogEntry.FieldNo(SystemCreatedAt), TableFilters);
    end;
```
<span data-ttu-id="63ca6-172">Una vez que un desarrollador ha agregado tablas a la lista, un administrador puede incluirlas en una directiva de retención.</span><span class="sxs-lookup"><span data-stu-id="63ca6-172">After a developer has added tables to the list, an administrator can include them in a retention policy.</span></span> 

## <a name="see-also"></a><span data-ttu-id="63ca6-173">Consulte también</span><span class="sxs-lookup"><span data-stu-id="63ca6-173">See Also</span></span>
[<span data-ttu-id="63ca6-174">Auditar cambios en Business Central</span><span class="sxs-lookup"><span data-stu-id="63ca6-174">Auditing Changes in Business Central</span></span>](across-log-changes.md)  
[<span data-ttu-id="63ca6-175">Filtrado</span><span class="sxs-lookup"><span data-stu-id="63ca6-175">Filtering</span></span>](ui-enter-criteria-filters.md#filtering)  
[<span data-ttu-id="63ca6-176">Uso de colas de proyectos para programar tareas</span><span class="sxs-lookup"><span data-stu-id="63ca6-176">Use Job Queues to Schedule Tasks</span></span>](admin-job-queues-schedule-tasks.md)  
<span data-ttu-id="63ca6-177">[Trabajar con [!INCLUDE[prod_short](includes/prod_short.md)]](ui-work-product.md)</span><span class="sxs-lookup"><span data-stu-id="63ca6-177">[Working with [!INCLUDE[prod_short](includes/prod_short.md)]](ui-work-product.md)</span></span>  

[!INCLUDE[footer-include](includes/footer-banner.md)]