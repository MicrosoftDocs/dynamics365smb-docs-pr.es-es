---
title: 'Detalles de diseño: Estructura de registro de seguimiento de productos | Documentos de Microsoft'
description: Aprender a usar movimientos de productos como soporte principal de los números de seguimiento de producto.
author: SorenGP
ms.service: dynamics365-business-central
ms.topic: article
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.keywords: design, item tracking, posting, inventory
ms.date: 10/01/2020
ms.author: edupont
ms.openlocfilehash: 697b83fd7e6e2b220b2851d5a1770ed9f74a9bdd
ms.sourcegitcommit: ddbb5cede750df1baba4b3eab8fbed6744b5b9d6
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 10/01/2020
ms.locfileid: "3917381"
---
# <a name="design-details-item-tracking-posting-structure"></a><span data-ttu-id="f52a2-103">Detalles de diseño: Estructura de registro de seguimiento de productos</span><span class="sxs-lookup"><span data-stu-id="f52a2-103">Design Details: Item Tracking Posting Structure</span></span>
<span data-ttu-id="f52a2-104">Para establecer la correspondencia con la funcionalidad de valoración de existencias y obtener una solución más simple y robusta, se usan los movimientos de producto como el soporte principal de los números de seguimiento de producto.</span><span class="sxs-lookup"><span data-stu-id="f52a2-104">To align with inventory costing functionality and to obtain a simpler and more robust solution, item ledger entries are used as the primary carrier of item tracking numbers.</span></span>  
  
<span data-ttu-id="f52a2-105">Los números de seguimiento de producto en las entidades de la red de pedidos y las entidades de red que no realizan pedidos se especifican en la tabla **Mov. reserva** (T337).</span><span class="sxs-lookup"><span data-stu-id="f52a2-105">Item tracking numbers on order network entities and non-order network entities are specified in the **Reservation Entry** table (T337).</span></span> <span data-ttu-id="f52a2-106">Los números de seguimiento de producto que están relacionados con la información histórica se recuperan directamente de los movimientos de producto relacionados con la transacción en cuestión.</span><span class="sxs-lookup"><span data-stu-id="f52a2-106">Item tracking numbers that are related to historical information are retrieved directly from the item ledger entries that are related to the transaction in question.</span></span> <span data-ttu-id="f52a2-107">Esto significa que los movimientos de producto reflejan la especificación de seguimiento de producto de la línea de pedido registrada.</span><span class="sxs-lookup"><span data-stu-id="f52a2-107">This means that item ledger entries reflect the item tracking specification of the posted order line.</span></span>  
  
<span data-ttu-id="f52a2-108">La página **Líns. seguim. prod.** recupera la información de T337 y de los movimientos de producto, y la muestra a través de la tabla temporal **Especificación seguimiento** (T336).</span><span class="sxs-lookup"><span data-stu-id="f52a2-108">The **Item Tracking Lines** page retrieves the information from T337 and the item ledger entries and shows it through the temporary table, **Tracking Specification** (T336).</span></span> <span data-ttu-id="f52a2-109">T336 también contiene los datos temporales de la página **Líns. seguim. prod.** para las cantidades de seguimiento de producto que se deben facturar.</span><span class="sxs-lookup"><span data-stu-id="f52a2-109">T336 also hold the temporary data in the **Item Tracking Lines page** for item tracking quantities that remain to be invoiced.</span></span>  
  
## <a name="one-to-many-relation"></a><span data-ttu-id="f52a2-110">Relación de uno a varios</span><span class="sxs-lookup"><span data-stu-id="f52a2-110">One-to-Many Relation</span></span>  
<span data-ttu-id="f52a2-111">La tabla **Relación mov. producto**, que se usa para vincular una línea de documento registrado con sus movimientos de producto relacionados, consta de dos partes principales:</span><span class="sxs-lookup"><span data-stu-id="f52a2-111">The **Item Entry Relation** table, which is used to link a posted document line with its related item ledger entries, consists of two main parts:</span></span>  
  
* <span data-ttu-id="f52a2-112">Un puntero a la línea de documento registrado, el **Nº línea pedido**.</span><span class="sxs-lookup"><span data-stu-id="f52a2-112">A pointer to the posted document line, the **Order Line No.**</span></span> <span data-ttu-id="f52a2-113">.</span><span class="sxs-lookup"><span data-stu-id="f52a2-113">field.</span></span>  
* <span data-ttu-id="f52a2-114">Un número de entrada que apunta a un movimiento de producto, el campo **Nº mov. producto**.</span><span class="sxs-lookup"><span data-stu-id="f52a2-114">An entry number pointing to an item ledger entry, the **Item Entry No.** field.</span></span>  
  
<span data-ttu-id="f52a2-115">La funcionalidad del campo **Nº mov.** existente, que relaciona un movimiento de producto con una línea de documento registrado, controla la relación uno a uno habitual cuando no hay números de seguimiento de producto en la línea de documento registrada.</span><span class="sxs-lookup"><span data-stu-id="f52a2-115">The functionality of the existing **Entry No.** field, which relates an item ledger entry to a posted document line, handles the typical one-to-one relation when no item tracking numbers exist on the posted document line.</span></span> <span data-ttu-id="f52a2-116">Si hay números de seguimiento de productos, el campo **Nº mov.** se deja en blanco, y la relación de uno a muchos se gestiona a través de la tabla **Relación mov. producto**.</span><span class="sxs-lookup"><span data-stu-id="f52a2-116">If item tracking numbers exist, then the **Entry No.** field is left blank, and the one-to-many relation is handled by the **Item Entry Relation** table.</span></span> <span data-ttu-id="f52a2-117">Si la línea de documento registrada lleva números de seguimiento de productos pero hace referencia a un único movimiento de producto, el campo **Nº mov.** administrará la relación, y no se creará ningún registro en la tabla **Relación mov. producto**.</span><span class="sxs-lookup"><span data-stu-id="f52a2-117">If the posted document line carries item tracking numbers but only relates to a single item ledger entry, then the **Entry No.** field handles the relation, and the no record is created in the **Item Entry Relation** table.</span></span>  
  
## <a name="codeunits-80-and-90"></a><span data-ttu-id="f52a2-118">Codeunits 80 y 90</span><span class="sxs-lookup"><span data-stu-id="f52a2-118">Codeunits 80 and 90</span></span>  
<span data-ttu-id="f52a2-119">Para dividir los movimientos de producto durante el registro, el código de codeunit 80 y codeunit 90, se encuentra entre bucles que recorren las variables de registro temporales globales.</span><span class="sxs-lookup"><span data-stu-id="f52a2-119">To split the item ledger entries during posting, the code in codeunit 80 and codeunit 90, is encircled by loops that run through global temporary record variables.</span></span> <span data-ttu-id="f52a2-120">Este código llama a la codeunit 22 con una línea de diario de productos.</span><span class="sxs-lookup"><span data-stu-id="f52a2-120">This code calls codeunit 22 with an item journal line.</span></span> <span data-ttu-id="f52a2-121">Estas variables se inicializan cuando hay números de seguimiento de producto para la línea de documento.</span><span class="sxs-lookup"><span data-stu-id="f52a2-121">These variables are initialized when item tracking numbers exist for the document line.</span></span> <span data-ttu-id="f52a2-122">Para simplificar el código, siempre se usa esta estructura de bucle.</span><span class="sxs-lookup"><span data-stu-id="f52a2-122">To keep the code simple, this looping structure is always used.</span></span> <span data-ttu-id="f52a2-123">Si no hay números de seguimiento para la línea del documento, se insertará un único registro y el bucle se ejecutará solo una vez.</span><span class="sxs-lookup"><span data-stu-id="f52a2-123">If no item tracking numbers exist for the document line, then a single record is inserted, and the loop runs only once.</span></span>  
  
## <a name="posting-the-item-journal"></a><span data-ttu-id="f52a2-124">Registro del diario de productos</span><span class="sxs-lookup"><span data-stu-id="f52a2-124">Posting the Item Journal</span></span>  
<span data-ttu-id="f52a2-125">Los números de seguimiento de producto se transfieren mediante los movimientos de reserva relacionados con el movimiento de producto y el recorrido en bucle por los números de seguimiento de producto se realiza en la codeunit 22.</span><span class="sxs-lookup"><span data-stu-id="f52a2-125">Item tracking numbers are transferred via the reservation entries that relate to the item ledger entry, and the looping through item tracking numbers occurs in codeunit 22.</span></span> <span data-ttu-id="f52a2-126">Este concepto funciona del mismo modo cuando una línea del diario de productos se usa indirectamente para registrar un pedido de compra o de venta que cuando una línea del diario de productos se usa directamente.</span><span class="sxs-lookup"><span data-stu-id="f52a2-126">This concept works in the same way when an item journal line is used indirectly to post a sale or purchase order as when an item journal line is used directly.</span></span> <span data-ttu-id="f52a2-127">Cuando el diario de producto se usa directamente, el campo **IdLínea origen** indica la línea del diario de producto.</span><span class="sxs-lookup"><span data-stu-id="f52a2-127">When the item journal is used directly, the **Source Row ID** field points to the item journal line itself.</span></span>  
  
## <a name="code-unit-22"></a><span data-ttu-id="f52a2-128">Codeunit 22</span><span class="sxs-lookup"><span data-stu-id="f52a2-128">Code Unit 22</span></span>  
<span data-ttu-id="f52a2-129">Las codeunits 80 y 90 examinan la llamada de la codeunit 22 durante el registro de factura de los números de seguimiento de productos y durante la facturación de envíos o recepciones existentes.</span><span class="sxs-lookup"><span data-stu-id="f52a2-129">Codeunits 80 and 90 loop the call of codeunit 22 during the invoice posting of item tracking numbers and during the invoicing of existing shipments or receipts.</span></span>  
  
<span data-ttu-id="f52a2-130">Durante el registro de la cantidad de números de seguimiento de productos, la codeunit 22 recupera los números de seguimiento de productos a partir de las entradas en T337 relativas al registro.</span><span class="sxs-lookup"><span data-stu-id="f52a2-130">During quantity posting of item tracking numbers, codeunit 22 retrieves item tracking numbers from the entries in T337 that relate to the posting.</span></span> <span data-ttu-id="f52a2-131">Estos movimientos se colocan directamente en la línea de diario de productos.</span><span class="sxs-lookup"><span data-stu-id="f52a2-131">These entries are placed directly on the item journal line.</span></span>  
  
<span data-ttu-id="f52a2-132">La codeunit 22 examina los números de seguimiento de producto y divide el registro en los movimientos correspondientes con ese número de seguimiento.</span><span class="sxs-lookup"><span data-stu-id="f52a2-132">Codeunit 22 loops through the item tracking numbers and splits the posting into the respective item ledger entries that carry the item tracking numbers.</span></span> <span data-ttu-id="f52a2-133">Se devuelve a T337 información sobre qué movimientos de producto se crean con un registro temporal T336, al cual llama un procedimiento en la codeunit 22.</span><span class="sxs-lookup"><span data-stu-id="f52a2-133">Information about which item ledger entries are created is returned to T337 by using a temporary T336 record, which is called by a procedure in codeunit 22.</span></span> <span data-ttu-id="f52a2-134">Este procedimiento se desencadena cuando la codeunit 22 ha terminado su ejecución porque en ese momento el objeto con codeunit 22 contiene información.</span><span class="sxs-lookup"><span data-stu-id="f52a2-134">This procedure is triggered when codeunit 22 has finished its run because at that point, the codeunit 22 object contains the information.</span></span> <span data-ttu-id="f52a2-135">Cuando se recupera el registro T336 temporal, las codeunits 80 y 90 crean registros en la tabla **Relación mov. producto** para vincular los movimientos de producto con la línea de envío o recepción creada.</span><span class="sxs-lookup"><span data-stu-id="f52a2-135">When the temporary T336 record is retrieved, codeunits 80 and 90 create records in the **Item Entry Relation** table to link the created item ledger entries to the created shipment or receipt line.</span></span> <span data-ttu-id="f52a2-136">Las codeunits 80 o 90 a continuación convierten los registros temporales T336 en registros reales T336 relacionados con la línea en cuestión.</span><span class="sxs-lookup"><span data-stu-id="f52a2-136">Codeunits 80 or codeunit 90 then converts the temporary T336 records to real T336 records that are related to the line in question.</span></span> <span data-ttu-id="f52a2-137">No obstante, esta conversión solo tienen lugar si la línea de documento registrada no se elimina, porque se registra solo parcialmente.</span><span class="sxs-lookup"><span data-stu-id="f52a2-137">However, this conversion occurs only if the posted document line is not deleted, because it is only partially posted.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f52a2-138">Consulte también</span><span class="sxs-lookup"><span data-stu-id="f52a2-138">See Also</span></span>  
<span data-ttu-id="f52a2-139">[Detalles de diseño: Seguimiento de productos](design-details-item-tracking.md) </span><span class="sxs-lookup"><span data-stu-id="f52a2-139">[Design Details: Item Tracking](design-details-item-tracking.md) </span></span>  
[<span data-ttu-id="f52a2-140">Detalles de diseño: Diseño de seguimiento de productos</span><span class="sxs-lookup"><span data-stu-id="f52a2-140">Design Details: Item Tracking Design</span></span>](design-details-item-tracking-design.md)